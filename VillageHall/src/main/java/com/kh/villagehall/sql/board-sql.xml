<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<comment>board-sql.xml</comment>
	
	<!-- 내 게시글 조회 -->
	<entry key="selectMyBoard">
		SELECT B.BOARD_NO, B.BOARD_TITLE, TO_CHAR(B.BOARD_CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS BOARD_CREATE_DATE, B.READ_COUNT, COUNT(L.BOARD_NO) AS LIKE_COUNT
		FROM BOARD B
		JOIN "USER" U ON B.USER_NO = U.USER_NO
		LEFT JOIN "LIKE" L ON B.BOARD_NO = L.BOARD_NO
		WHERE U.USER_NO = ?
		AND BOARD_DELETE_FG = 'N'
		GROUP BY B.BOARD_NO, B.BOARD_TITLE, B.BOARD_CREATE_DATE, B.READ_COUNT
		ORDER BY B.BOARD_NO DESC
	</entry>
	
	<!-- 내 좋아요 조회 -->
	<entry key="selectMyLike">
		SELECT B.BOARD_NO, B.BOARD_TITLE, TO_CHAR(B.BOARD_CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS BOARD_CREATE_DATE, U.USER_NICKNAME, B.READ_COUNT, COUNT(*) AS LIKE_COUNT
		FROM BOARD B
		JOIN "USER" U ON B.USER_NO = U.USER_NO
		LEFT JOIN "LIKE" L ON B.BOARD_NO = L.BOARD_NO
		WHERE B.BOARD_DELETE_FG = 'N' AND B.BOARD_NO IN (SELECT BOARD_NO FROM "LIKE" WHERE USER_NO = ? )
		GROUP BY B.BOARD_NO, B.BOARD_TITLE, B.BOARD_CREATE_DATE, U.USER_NICKNAME, B.READ_COUNT
		ORDER BY B.BOARD_NO DESC
	</entry>
	
	
	<!-- 전체 게시글 조회 -->
	<entry key="selectAllBoard">
		SELECT B.BOARD_NO, B.BOARD_TITLE, TO_CHAR(B.BOARD_CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS BOARD_CREATE_DATE, USER_NICKNAME ,B.READ_COUNT, COUNT(L.BOARD_NO) AS LIKE_COUNT
		FROM BOARD B
		JOIN "USER" U ON B.USER_NO = U.USER_NO
		LEFT JOIN "LIKE" L ON B.BOARD_NO = L.BOARD_NO
		WHERE BOARD_DELETE_FG = 'N'
		GROUP BY B.BOARD_NO, B.BOARD_TITLE, B.BOARD_CREATE_DATE, USER_NICKNAME, B.READ_COUNT
		ORDER BY B.BOARD_NO DESC
	</entry>
	
	<!-- 게시글 상세 조회 -->
	<entry key="selectBoardDetail">
		SELECT BOARD_NO, BOARD_TITLE, USER_NICKNAME, BOARD_CONTENT
		FROM BOARD
		JOIN "USER" USING (USER_NO)
		WHERE BOARD_DELETE_FG = 'N' AND BOARD_NO = ?
	</entry>
	
  <!-- 카카오맵리스트  -->
	 <entry key="kakaoMapList">
	  SELECT BOARD_TITLE, BOARD_CONTENT ,BOARD_CREATE_DATE , LATITUDE ,LONGITUDE, CATEGORY_NAME, USER_NICKNAME, BOARD_NO
	  FROM BOARD
	  LEFT JOIN "USER" "LIKE"  USING(USER_NO)
	  LEFT JOIN "CATEGORY"  USING(CATEGORY_NO)

	</entry>
	
	<!-- 조회수 증가  -->
	<entry key="updateRead">
		UPDATE BOARD SET READ_COUNT = READ_COUNT +1
		WHERE BOARD_NO = ?	
	</entry>
	
	<!-- 좋아요 확인 -->
	<entry key="selectLike">
		SELECT COUNT(*)
		FROM "LIKE"
		WHERE USER_NO = ? AND BOARD_NO = ?
	</entry>
	
	<!-- 좋아요 추가 -->
	<entry key="updateLike">
		INSERT INTO "LIKE" VALUES (?, ?)
	</entry>
	
	<!-- 좋아요 삭제 -->
	<entry key="deleteLike">
		DELETE FROM "LIKE" WHERE USER_NO = ? AND BOARD_NO = ?
	</entry>
	
	<entry key="deleteBoard">
		UPDATE BOARD SET BOARD_DELETE_FG = 'Y'
		WHERE BOARD_NO = ?
	</entry>
	
	<!-- 인기 게시글 조회 -->
	<entry key="selectPopularBoard">
		SELECT B.BOARD_NO, B.BOARD_TITLE, TO_CHAR(B.BOARD_CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS BOARD_CREATE_DATE, USER_NICKNAME ,B.READ_COUNT, COUNT(L.BOARD_NO) AS LIKE_COUNT
		FROM BOARD B
		JOIN "USER" U ON B.USER_NO = U.USER_NO
		LEFT JOIN "LIKE" L ON B.BOARD_NO = L.BOARD_NO
		WHERE BOARD_DELETE_FG = 'N'
		GROUP BY B.BOARD_NO, B.BOARD_TITLE, B.BOARD_CREATE_DATE, USER_NICKNAME, B.READ_COUNT
		ORDER BY ? DESC
	</entry>
	
</properties>